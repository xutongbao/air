(this.webpackJsonpair=this.webpackJsonpair||[]).push([[10],{334:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var a=n(31),i=n(148),r=(n(49),function(e){return function(t){i.a.light.routerSearch().then((function(n){200===n.code&&(t({type:"SET_LIGHT_STATE",key:["routerForApp"],value:n.data}),e&&e())}))}}),c=function(){return function(e){var t=localStorage.getItem("userInfoAdmin")?JSON.parse(localStorage.getItem("userInfoAdmin")):{};e({type:"SET_LIGHT_STATE",key:["userInfo"],value:Object(a.a)({},t)})}}},384:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(101),r=n(31),c=n(25),o=n(121),l=n(73),d=n(374),s=n(213),u=n(44),m=n(100),j=n(9),p=n(132),b=n(131),f=n(148),h=n(334),O=d.a.confirm;var g=Object(i.b)((function(e){return{routerForApp:e.getIn(["light","routerForApp"]).toJS()}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=function(e){var t=s.a.useForm(),n=Object(b.a)(t,1)[0],i=Object(a.useState)(!1),c=Object(b.a)(i,2),o=c[0],l=c[1],d=Object(a.useState)({}),u=Object(b.a)(d,2),m=u[0],j=u[1],p=Object(a.useState)("add"),g=Object(b.a)(p,2),x=g[0],y=g[1],v=Object(a.useState)(),I=Object(b.a)(v,2),S=I[0],N=I[1],A=e.routerForApp,C={},F=function(){e.onDispatch(Object(h.a)())};return Object(a.useEffect)((function(){F()}),[]),Object(a.useEffect)((function(){n.resetFields()}),[o,n]),{isModalVisible:o,initValues:m,type:x,form:n,modalTitle:S,handleDelete:function(t){console.log("\u5220\u9664, id:",t),O({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){f.a.light.routerDelete({ids:[t]}).then((function(t){200===t.code&&e.onDispatch(Object(h.a)())}))}})},handleAdd:function(){y("add"),N("\u6dfb\u52a0\u5e94\u7528"),j(C),console.log(C),l(!0)},handleEdit:function(e){var t=A.find((function(t){return t.id===e}));console.log("\u7f16\u8f91, id:",t),y("edit"),N("\u4fee\u6539\u540d\u79f0"),j(Object(r.a)(Object(r.a)({},m),t)),l(!0)},setIsModalVisible:l,handleFinish:function(e){console.log("Success:",e),"add"===x?(e.path="/light/index/content",f.a.light.routerAdd({dataItem:e}).then((function(e){200===e.code&&(l(!1),F())}))):"edit"===x&&f.a.light.routerEdit({id:m.id,dataItem:Object(r.a)(Object(r.a)({},m),e)}).then((function(e){200===e.code&&(l(!1),F())}))},handleFinishFailed:function(e){console.log("Failed:",e)},handleJumpToSet:function(t){e.history.push("/light/admin/app?type=detail&id=".concat(t,"&progress=edit"))}}}(e),n=t.isModalVisible,i=t.initValues,c=t.type,g=t.form,x=t.modalTitle,y=t.handleDelete,v=t.handleAdd,I=t.handleEdit,S=t.setIsModalVisible,N=t.handleFinish,A=t.handleFinishFailed,C=t.handleJumpToSet,F=e.routerForApp;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"m-admin-content home",children:[Object(j.jsxs)("div",{className:"m-admin-row",children:[Object(j.jsx)("div",{className:"m-adimn-row-title",children:"\u81ea\u5b9a\u4e49\u5e94\u7528"}),Object(j.jsxs)("div",{className:"m-app-wrap",children:[F.map((function(e){return Object(j.jsxs)("div",{className:"m-app-item",title:e.title,onClick:function(){return C(e.id)},children:[Object(j.jsx)(o.a,{overlay:Object(j.jsxs)(l.a,{onClick:function(e){return e.domEvent.stopPropagation()},children:[Object(j.jsx)(l.a.Item,{onClick:function(){return I(e.id)},children:"\u4fee\u6539\u540d\u79f0"},"0"),Object(j.jsx)(l.a.Item,{onClick:function(){return y(e.id)},children:"\u5220\u9664\u5e94\u7528"},"1")]}),children:Object(j.jsx)("span",{className:"m-app-item-icon",children:Object(j.jsx)(p.c,{name:"more"})})}),e.title]},e.id)})),Object(j.jsxs)("div",{className:"m-app-item",onClick:v,children:[Object(j.jsx)(p.c,{name:"add",className:"m-application-icon"}),"\u521b\u5efa\u65b0\u5e94\u7528"]})]})]}),Object(j.jsx)(d.a,{title:x,visible:n,onCancel:function(){return S(!1)},footer:null,forceRender:!0,children:Object(j.jsxs)(s.a,{form:g,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(r.a)({},i),onFinish:N,onFinishFailed:A,children:[Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(s.a.Item,{label:"\u5e94\u7528\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})})}),Object(j.jsxs)(s.a.Item,{wrapperCol:{offset:4,span:17},className:"m-modal-footer",children:[("add"===c||"edit"===c)&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(u.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(j.jsx)(p.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(j.jsxs)(u.a,{className:"m-space",onClick:function(){g.resetFields()},children:[Object(j.jsx)(p.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]}),Object(j.jsx)(u.a,{className:"m-space",onClick:function(){return S(!1)},children:"\u53d6\u6d88"})]})]})})]})})}))),x=n(387),y=n(342),v=n(337),I=n(389),S=n(130),N=I.a.Step;var A=Object(c.g)((function(e){var t=e.applicationTitle,n=e.routerSearchObj,i=e.onSave,r=Object(a.useState)(0),c=Object(b.a)(r,2),o=c[0],l=c[1],d=[{id:0,title:"\u7f16\u8f91",type:"edit",path:"/light/admin/app?type=detail&id=".concat(n.id,"&progress=edit")},{id:1,title:"\u76ae\u80a4",type:"skin",path:"/light/admin/app?type=detail&id=".concat(n.id,"&progress=skin")},{id:2,title:"\u8bbe\u7f6e",type:"set",path:"/light/admin/app?type=detail&id=".concat(n.id,"&progress=set")},{id:3,title:"\u53d1\u5e03",type:"publish",path:"/light/admin/app?type=detail&id=".concat(n.id,"&progress=publish")}];return Object(a.useEffect)((function(){var e=d.find((function(e){return e.type===n.progress}));l(e.id)}),[]),Object(j.jsxs)("div",{className:"m-design-header",children:[Object(j.jsxs)("div",{className:"m-design-header-title",children:[Object(j.jsx)(p.c,{name:"goback",title:"\u8fd4\u56de",className:"m-set-application-header-icon",onClick:function(){return e.history.go(-1)}}),Object(j.jsx)("span",{title:t,children:t})]}),Object(j.jsx)("div",{className:"m-design-header-middle",children:Object(j.jsx)("div",{className:"m-design-header-middle-inner",children:Object(j.jsx)(I.a,{current:o,onChange:function(t){var n=d.find((function(e){return e.id===t}));e.history.replace(n.path)},children:d.map((function(e){return Object(j.jsx)(N,{title:e.title},e.id)}))})})}),Object(j.jsxs)("div",{className:"m-design-header-action",children:[Object(j.jsx)(u.a,{type:"primary",onClick:i,children:"\u4fdd\u5b58"}),Object(j.jsx)(S.b,{to:"/light/formview?id=".concat(n.id),target:"_blank",style:{display:"inherit"},children:Object(j.jsx)(u.a,{children:"\u9884\u89c8"})})]})]})})),C=n(330),F=n(209),H=n(49),T=n(376),D=function(e){var t=e.initValuesForAttr;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(s.a.Item,{label:"\u5b57\u6bb5\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})}),t.isHasPlaceHolder&&Object(j.jsx)(s.a.Item,{label:"placeholder",name:"placeholder",children:Object(j.jsx)(m.a,{})}),Object(j.jsx)(s.a.Item,{label:"\u82f1\u6587\u540d\u79f0",name:"dataIndex",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})}),t.isHasRules&&Object(j.jsx)(s.a.Item,{label:"\u5b57\u6bb5\u5fc5\u586b",name:"rules",children:Object(j.jsx)(p.b,{})}),"image"===t.type&&Object(j.jsx)(s.a.Item,{label:"\u4e0a\u4f20\u56fe\u7247",name:"src",children:Object(j.jsx)(p.g,{})})]})},E=d.a.confirm,k=[];function P(e){var t=s.a.useForm(),n=Object(b.a)(t,1)[0],i=s.a.useForm(),c=Object(b.a)(i,1)[0],o=Object(a.useState)([]),l=Object(b.a)(o,2),d=l[0],u=l[1],m=Object(a.useState)(),j=Object(b.a)(m,2),p=j[0],h=j[1],O=Object(a.useState)(),g=Object(b.a)(O,2),x=g[0],y=g[1],v=Object(a.useState)({}),I=Object(b.a)(v,2),S=I[0],N=I[1],A=Object(H.g)(e),D=A.id,P=function(){f.a.light.fieldsSearch({tableId:D}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));u(t),h(e.data.title),Array.isArray(t)&&t.length>0&&w({id:t[0].id,myDataSource:t})}}))},w=function(e){var t=e.id,n=e.myDataSource,a=void 0===n?d:n;y(t);var i=a.find((function(e){return e.id===t})),c=Array.isArray(i.rules)&&i.rules.length>0?i.rules[0]:{message:"".concat(i.title,"\u4e0d\u80fd\u4e3a\u7a7a")};N(Object(r.a)(Object(r.a)({},i),{},{rules:c}))};return Object(a.useEffect)((function(){c.resetFields()}),[S]),Object(a.useEffect)((function(){P()}),[]),Object(a.useEffect)((function(){k=d}),[d]),{form:n,formForAttr:c,initValuesForAttr:S,dataSource:d,applicationTitle:p,addInitValues:{},routerSearchObj:A,cardActiveId:x,handleSearch:P,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),E({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=d.filter((function(e){return e.id!==t.id}));u(e),Array.isArray(e)&&e.length>0?t.id===x&&w({id:e[0].id,myDataSource:e}):y(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,n=k.map((function(e){return e.orderIndex})),a=Math.max.apply(Math,n)+1,i=Object(T.a)(),c={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:a};console.log(Object(r.a)(Object(r.a)({},t),c)),console.log(k);var o=[].concat(Object(C.a)(k),[Object(r.a)(Object(r.a)({},t),c)]);u(o),Array.isArray(o)&&o.length>0&&w({id:i,myDataSource:o})},handleSave:function(){console.log(d);var e=d.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{orderIndex:t+1})}));console.log(e),f.a.light.fieldsEditAll({tableId:D,dataItem:e}).then((function(e){200===e.code&&F.b.success(e.message)}))},handleCardActiveId:w,handleValuesChange:function(e,t){var n=c.getFieldsValue();console.log(n);var a=d.findIndex((function(e){return e.id===x})),i={rules:[t.rules],props:{placeholder:t.placeholder}};d[a]=Object(r.a)(Object(r.a)(Object(r.a)({},d[a]),t),i),u(Object(C.a)(d))},handleGetChildPayload:function(e){var t=e.type,n=e.index;if("tool"===t){var a=Object(T.a)(),i=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],c=k.map((function(e){return e.orderIndex})),o=Math.max.apply(Math,c)+1,l=i[n],s={id:a,dataIndex:"".concat(l.dataIndex,"-").concat(a),isModalField:!0,orderIndex:o};return Object(r.a)(Object(r.a)({},l),s)}if("content"===t)return d[n]},handleCardDrop:function(e){var t=e.type,n=e.dragResult;if("tool"===t);else if("content"===t){var a=function(e,t){var n=t.removedIndex,a=t.addedIndex,i=t.payload;if(null===n&&null===a)return e;var r=Object(C.a)(e),c=i;return null!==n&&(c=r.splice(n,1)[0]),null!==a&&r.splice(a,0,c),r}(d,n);u(a),Array.isArray(a)&&a.length>0&&w({id:n.payload.id,myDataSource:a})}}}}var w=n(338),M=x.a.Panel;var R=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=P(e),n=t.applicationTitle,a=t.dataSource,i=t.form,c=t.formForAttr,o=t.initValues,l=t.initValuesForAttr,d=t.routerSearchObj,b=t.cardActiveId,f=t.handleFinish,h=t.handleFinishFailed,O=t.handleAdd,g=t.handleSave,I=t.handleCardActiveId,S=t.handleValuesChange,N=t.handleDelete,C=t.handleGetChildPayload,F=t.handleCardDrop;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(A,{applicationTitle:n,routerSearchObj:d,onSave:g}),Object(j.jsxs)("div",{className:"m-design-wrap",children:[Object(j.jsx)("div",{className:"m-design-sidebar",children:Object(j.jsxs)(x.a,{defaultActiveKey:["1","2","3"],children:[Object(j.jsx)(M,{header:"\u901a\u7528\u5b57\u6bb5",children:Object(j.jsx)("div",{className:"m-design-sidebar-container",children:Object(j.jsx)(w.Container,{orientation:"horizontal",onDrop:function(e){return F({type:"tool",dragResult:e})},getChildPayload:function(e){return C({type:"tool",index:e})},behaviour:"copy",groupName:"col",children:[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}].map((function(e){return Object(j.jsx)(w.Draggable,{children:Object(j.jsxs)("div",{className:"m-component-item",onClick:function(){return O({fieldInfo:e})},children:[Object(j.jsx)("div",{children:Object(j.jsx)(p.c,{name:e.icon})}),Object(j.jsx)("div",{children:e.title})]})},e.id)}))})})},"1"),Object(j.jsx)(M,{header:"\u8054\u7cfb\u4fe1\u606f\u5b57\u6bb5",children:Object(j.jsx)(y.a,{gutter:[2,2],children:Object(j.jsx)(v.a,{span:8,children:Object(j.jsxs)("div",{className:"m-component-item",children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{children:"\u656c\u8bf7\u671f\u5f85"})]})})})},"2"),Object(j.jsx)(M,{header:"\u5546\u54c1\u5b57\u6bb5",children:Object(j.jsx)(y.a,{gutter:[2,2],children:Object(j.jsx)(v.a,{span:8,children:Object(j.jsxs)("div",{className:"m-component-item",children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{children:"\u656c\u8bf7\u671f\u5f85"})]})})})},"3")]})}),Object(j.jsx)("div",{className:"m-design-content",children:Object(j.jsxs)(s.a,{form:i,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(r.a)({},o),onFinish:f,onFinishFailed:h,children:[Object(j.jsx)("div",{className:"m-design-card-wrap",children:Object(j.jsx)(w.Container,{orientation:"vertical",onDrop:function(e){return F({type:"content",dragResult:e})},getChildPayload:function(e){return C({type:"content",index:e})},groupName:"col",children:a.map((function(e){var t=Object(H.d)().find((function(t){return t.formComponentName===e.formComponentName}));return Object(j.jsx)(w.Draggable,{children:Object(j.jsxs)("div",{className:"m-design-card ".concat(b===e.id?"active":""),onClick:function(){return I({id:e.id})},children:[Object(j.jsxs)("div",{className:"m-design-card-info",children:["formItem"===e.type&&Object(j.jsx)(s.a.Item,{label:e.title,name:e.dataIndex,rules:e.rules,children:t?t.getComponent({props:e.props}):Object(j.jsx)(m.a,{})},e.id),"image"===e.type&&Object(j.jsx)(s.a.Item,{name:e.dataIndex,wrapperCol:24,children:t?t.getComponent({props:{src:e.src}}):Object(j.jsx)(m.a,{})},e.id)]}),Object(j.jsx)("div",{className:"m-design-card-action ".concat(b===e.id?"active":""),children:Object(j.jsx)(p.c,{name:"delete",className:"m-design-card-delete",onClick:function(t){return N(t,e)}})})]})},e.id)}))})}),Object(j.jsxs)(s.a.Item,{wrapperCol:{offset:4,span:17},className:"m-design-footer",children:[Object(j.jsxs)(u.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(j.jsx)(p.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(j.jsxs)(u.a,{className:"m-space",onClick:function(){i.resetFields()},children:[Object(j.jsx)(p.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]})]})}),Object(j.jsx)("div",{className:"m-design-attr",children:Object(j.jsx)(s.a,{form:c,labelCol:{span:8},wrapperCol:{span:15},initialValues:Object(r.a)({},l),scrollToFirstError:!0,onValuesChange:S,onFinish:f,id:"m-set-application-modal-form",className:"m-set-application-modal-form",children:b?D({initValuesForAttr:l}):Object(j.jsx)("div",{className:"m-empty-text",children:"\u8bf7\u9009\u62e9\u5b57\u6bb5"})})})]})]})}))),V=d.a.confirm,_=[];function G(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)(),l=Object(b.a)(o,2),d=l[0],s=l[1],u=Object(a.useState)(),m=Object(b.a)(u,2),j=m[0],p=m[1],h=Object(a.useState)({}),O=Object(b.a)(h,2),g=O[0],x=O[1],y=Object(H.g)(e),v=y.id,I=function(){f.a.light.fieldsSearch({tableId:v}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));c(t),s(e.data.title),Array.isArray(t)&&t.length>0&&S({id:t[0].id,myDataSource:t})}}))},S=function(e){var t=e.id,n=e.myDataSource,a=void 0===n?i:n;p(t);var c=a.find((function(e){return e.id===t})),o=Array.isArray(c.rules)&&c.rules.length>0?c.rules[0]:{message:"".concat(c.title,"\u4e0d\u80fd\u4e3a\u7a7a")};x(Object(r.a)(Object(r.a)({},c),{},{rules:o}))};return Object(a.useEffect)((function(){I()}),[]),Object(a.useEffect)((function(){_=i}),[i]),{initValuesForAttr:g,dataSource:i,applicationTitle:d,addInitValues:{},routerSearchObj:y,cardActiveId:j,handleSearch:I,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),V({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=i.filter((function(e){return e.id!==t.id}));c(e),Array.isArray(e)&&e.length>0?t.id===j&&S({id:e[0].id,myDataSource:e}):p(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,n=_.map((function(e){return e.orderIndex})),a=Math.max.apply(Math,n)+1,i=Object(T.a)(),o={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:a};console.log(Object(r.a)(Object(r.a)({},t),o)),console.log(_);var l=[].concat(Object(C.a)(_),[Object(r.a)(Object(r.a)({},t),o)]);c(l),Array.isArray(l)&&l.length>0&&S({id:i,myDataSource:l})},handleSave:function(){console.log(i);var e=i.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{orderIndex:t+1})}));console.log(e),f.a.light.fieldsEditAll({tableId:v,dataItem:e}).then((function(e){200===e.code&&F.b.success(e.message)}))},handleCardActiveId:S,handleValuesChange:function(e,t){},handleGetChildPayload:function(e){var t=e.type,n=e.index;if("tool"===t){var a=Object(T.a)(),c=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],o=_.map((function(e){return e.orderIndex})),l=Math.max.apply(Math,o)+1,d=c[n],s={id:a,dataIndex:"".concat(d.dataIndex,"-").concat(a),isModalField:!0,orderIndex:l};return Object(r.a)(Object(r.a)({},d),s)}if("content"===t)return i[n]},handleCardDrop:function(e){var t=e.type,n=e.dragResult;if("tool"===t);else if("content"===t){var a=function(e,t){var n=t.removedIndex,a=t.addedIndex,i=t.payload;if(null===n&&null===a)return e;var r=Object(C.a)(e),c=i;return null!==n&&(c=r.splice(n,1)[0]),null!==a&&r.splice(a,0,c),r}(i,n);c(a),Array.isArray(a)&&a.length>0&&S({id:n.payload.id,myDataSource:a})}}}}var L=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=G(e),n=t.applicationTitle,a=t.routerSearchObj,i=t.handleSave;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(A,{applicationTitle:n,routerSearchObj:a,onSave:i}),Object(j.jsx)("div",{className:"m-empty-page",children:"\u5360\u4f4d\u7a7a\u9875\u9762"})]})}))),J=d.a.confirm,q=[];function z(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)(),l=Object(b.a)(o,2),d=l[0],s=l[1],u=Object(a.useState)(),m=Object(b.a)(u,2),j=m[0],p=m[1],h=Object(a.useState)({}),O=Object(b.a)(h,2),g=O[0],x=O[1],y=Object(H.g)(e),v=y.id,I=function(){f.a.light.fieldsSearch({tableId:v}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));c(t),s(e.data.title),Array.isArray(t)&&t.length>0&&S({id:t[0].id,myDataSource:t})}}))},S=function(e){var t=e.id,n=e.myDataSource,a=void 0===n?i:n;p(t);var c=a.find((function(e){return e.id===t})),o=Array.isArray(c.rules)&&c.rules.length>0?c.rules[0]:{message:"".concat(c.title,"\u4e0d\u80fd\u4e3a\u7a7a")};x(Object(r.a)(Object(r.a)({},c),{},{rules:o}))};return Object(a.useEffect)((function(){I()}),[]),Object(a.useEffect)((function(){q=i}),[i]),{initValuesForAttr:g,dataSource:i,applicationTitle:d,addInitValues:{},routerSearchObj:y,cardActiveId:j,handleSearch:I,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),J({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=i.filter((function(e){return e.id!==t.id}));c(e),Array.isArray(e)&&e.length>0?t.id===j&&S({id:e[0].id,myDataSource:e}):p(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,n=q.map((function(e){return e.orderIndex})),a=Math.max.apply(Math,n)+1,i=Object(T.a)(),o={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:a};console.log(Object(r.a)(Object(r.a)({},t),o)),console.log(q);var l=[].concat(Object(C.a)(q),[Object(r.a)(Object(r.a)({},t),o)]);c(l),Array.isArray(l)&&l.length>0&&S({id:i,myDataSource:l})},handleSave:function(){console.log(i);var e=i.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{orderIndex:t+1})}));console.log(e),f.a.light.fieldsEditAll({tableId:v,dataItem:e}).then((function(e){200===e.code&&F.b.success(e.message)}))},handleCardActiveId:S,handleValuesChange:function(e,t){},handleGetChildPayload:function(e){var t=e.type,n=e.index;if("tool"===t){var a=Object(T.a)(),c=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],o=q.map((function(e){return e.orderIndex})),l=Math.max.apply(Math,o)+1,d=c[n],s={id:a,dataIndex:"".concat(d.dataIndex,"-").concat(a),isModalField:!0,orderIndex:l};return Object(r.a)(Object(r.a)({},d),s)}if("content"===t)return i[n]},handleCardDrop:function(e){var t=e.type,n=e.dragResult;if("tool"===t);else if("content"===t){var a=function(e,t){var n=t.removedIndex,a=t.addedIndex,i=t.payload;if(null===n&&null===a)return e;var r=Object(C.a)(e),c=i;return null!==n&&(c=r.splice(n,1)[0]),null!==a&&r.splice(a,0,c),r}(i,n);c(a),Array.isArray(a)&&a.length>0&&S({id:n.payload.id,myDataSource:a})}}}}var K=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=z(e),n=t.applicationTitle,a=t.routerSearchObj,i=t.handleSave;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(A,{applicationTitle:n,routerSearchObj:a,onSave:i}),Object(j.jsx)("div",{className:"m-empty-page",children:"\u5360\u4f4d\u7a7a\u9875\u9762"})]})}))),B=d.a.confirm,Q=[];function U(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)(),l=Object(b.a)(o,2),d=l[0],s=l[1],u=Object(a.useState)(),m=Object(b.a)(u,2),j=m[0],p=m[1],h=Object(a.useState)({}),O=Object(b.a)(h,2),g=O[0],x=O[1],y=Object(H.g)(e),v=y.id,I=function(){f.a.light.fieldsSearch({tableId:v}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));c(t),s(e.data.title),Array.isArray(t)&&t.length>0&&S({id:t[0].id,myDataSource:t})}}))},S=function(e){var t=e.id,n=e.myDataSource,a=void 0===n?i:n;p(t);var c=a.find((function(e){return e.id===t})),o=Array.isArray(c.rules)&&c.rules.length>0?c.rules[0]:{message:"".concat(c.title,"\u4e0d\u80fd\u4e3a\u7a7a")};x(Object(r.a)(Object(r.a)({},c),{},{rules:o}))};return Object(a.useEffect)((function(){I()}),[]),Object(a.useEffect)((function(){Q=i}),[i]),{initValuesForAttr:g,dataSource:i,applicationTitle:d,addInitValues:{},routerSearchObj:y,cardActiveId:j,handleSearch:I,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),B({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=i.filter((function(e){return e.id!==t.id}));c(e),Array.isArray(e)&&e.length>0?t.id===j&&S({id:e[0].id,myDataSource:e}):p(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,n=Q.map((function(e){return e.orderIndex})),a=Math.max.apply(Math,n)+1,i=Object(T.a)(),o={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:a};console.log(Object(r.a)(Object(r.a)({},t),o)),console.log(Q);var l=[].concat(Object(C.a)(Q),[Object(r.a)(Object(r.a)({},t),o)]);c(l),Array.isArray(l)&&l.length>0&&S({id:i,myDataSource:l})},handleSave:function(){console.log(i);var e=i.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{orderIndex:t+1})}));console.log(e),f.a.light.fieldsEditAll({tableId:v,dataItem:e}).then((function(e){200===e.code&&F.b.success(e.message)}))},handleCardActiveId:S,handleValuesChange:function(e,t){},handleGetChildPayload:function(e){var t=e.type,n=e.index;if("tool"===t){var a=Object(T.a)(),c=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],o=Q.map((function(e){return e.orderIndex})),l=Math.max.apply(Math,o)+1,d=c[n],s={id:a,dataIndex:"".concat(d.dataIndex,"-").concat(a),isModalField:!0,orderIndex:l};return Object(r.a)(Object(r.a)({},d),s)}if("content"===t)return i[n]},handleCardDrop:function(e){var t=e.type,n=e.dragResult;if("tool"===t);else if("content"===t){var a=function(e,t){var n=t.removedIndex,a=t.addedIndex,i=t.payload;if(null===n&&null===a)return e;var r=Object(C.a)(e),c=i;return null!==n&&(c=r.splice(n,1)[0]),null!==a&&r.splice(a,0,c),r}(i,n);c(a),Array.isArray(a)&&a.length>0&&S({id:n.payload.id,myDataSource:a})}}}}var W=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=U(e),n=t.applicationTitle,a=t.routerSearchObj,i=t.handleSave;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(A,{applicationTitle:n,routerSearchObj:a,onSave:i}),Object(j.jsx)("div",{className:"m-empty-page",children:"\u5360\u4f4d\u7a7a\u9875\u9762"})]})})));var X=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(c.g)((function(e){var t=Object(H.g)(e),n=function(){var e={edit:{component:Object(j.jsx)(R,{})},skin:{component:Object(j.jsx)(L,{})},set:{component:Object(j.jsx)(K,{})},publish:{component:Object(j.jsx)(W,{})}};return t.progress?e[t.progress]?e[t.progress].component:null:Object(j.jsx)(R,{})};return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(j.Fragment,{children:n()})})})));t.default=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))((function(e){var t=Object(H.g)(e),n=function(){var e={list:{component:Object(j.jsx)(g,{})}};return t.type?e[t.type]?e[t.type].component:null:Object(j.jsx)(g,{})};return Object(j.jsx)(j.Fragment,{children:"detail"===t.type?Object(j.jsx)(X,{}):Object(j.jsx)(j.Fragment,{children:n()})})}))}}]);