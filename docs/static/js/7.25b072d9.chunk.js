(this.webpackJsonpair=this.webpackJsonpair||[]).push([[7],{330:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(141);var o=n(151);function c(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},337:function(e,t,n){"use strict";var a=n(124);t.a=a.a},374:function(e,t,n){"use strict";var a=n(1),o=n(2),c=n(0),r=n(341),i=n(4),l=n.n(i),s=n(76),u=n(6),f=n(5);var d=n(44),b=n(149),m=function(e){var t=c.useRef(!1),n=c.useRef(),a=c.useState(!1),r=Object(f.a)(a,2),i=r[0],l=r[1];c.useEffect((function(){var t;if(e.autoFocus){var a=n.current;t=setTimeout((function(){return a.focus()}))}return function(){t&&clearTimeout(t)}}),[]);var s=e.type,u=e.children,m=e.prefixCls,j=e.buttonProps;return c.createElement(d.a,Object(o.a)({},Object(b.a)(s),{onClick:function(){var n=e.actionFn,a=e.closeModal;if(!t.current)if(t.current=!0,n){var o;if(n.length)o=n(a),t.current=!1;else if(!(o=n()))return void a();!function(n){var a=e.closeModal;n&&n.then&&(l(!0),n.then((function(){a.apply(void 0,arguments)}),(function(e){console.error(e),l(!1),t.current=!1})))}(o)}else a()},loading:i,prefixCls:m},j,{ref:n}),u)},j=n(18),p=n(19),O=n(61),v=function(e){var t=e.icon,n=e.onCancel,o=e.onOk,r=e.close,i=e.zIndex,s=e.afterClose,u=e.visible,f=e.keyboard,d=e.centered,b=e.getContainer,v=e.maskStyle,h=e.okText,g=e.okButtonProps,C=e.cancelText,y=e.cancelButtonProps,x=e.direction,k=e.prefixCls,S=e.rootPrefixCls,E=e.bodyStyle,T=e.closable,N=void 0!==T&&T,w=e.closeIcon,F=e.modalRender,P=e.focusTriggerAfterClose;Object(j.a)(!("string"===typeof t&&t.length>2),"Modal","`icon` is using ReactNode instead of string naming in v4. Please check `".concat(t,"` at https://ant.design/components/icon"));var I=e.okType||"primary",A="".concat(k,"-confirm"),z=!("okCancel"in e)||e.okCancel,M=e.width||416,R=e.style||{},V=void 0===e.mask||e.mask,B=void 0!==e.maskClosable&&e.maskClosable,D=null!==e.autoFocusButton&&(e.autoFocusButton||"ok"),L=l()(A,"".concat(A,"-").concat(e.type),Object(a.a)({},"".concat(A,"-rtl"),"rtl"===x),e.className),H=z&&c.createElement(m,{actionFn:n,closeModal:r,autoFocus:"cancel"===D,buttonProps:y,prefixCls:"".concat(S,"-btn")},C);return c.createElement(X,{prefixCls:k,className:L,wrapClassName:l()(Object(a.a)({},"".concat(A,"-centered"),!!e.centered)),onCancel:function(){return r({triggerCancel:!0})},visible:u,title:"",footer:"",transitionName:Object(O.b)(S,"zoom",e.transitionName),maskTransitionName:Object(O.b)(S,"fade",e.maskTransitionName),mask:V,maskClosable:B,maskStyle:v,style:R,width:M,zIndex:i,afterClose:s,keyboard:f,centered:d,getContainer:b,closable:N,closeIcon:w,modalRender:F,focusTriggerAfterClose:P},c.createElement("div",{className:"".concat(A,"-body-wrapper")},c.createElement(p.a,{prefixCls:S},c.createElement("div",{className:"".concat(A,"-body"),style:E},t,void 0===e.title?null:c.createElement("span",{className:"".concat(A,"-title")},e.title),c.createElement("div",{className:"".concat(A,"-content")},e.content))),c.createElement("div",{className:"".concat(A,"-btns")},H,c.createElement(m,{type:I,actionFn:o,closeModal:r,autoFocus:"ok"===D,buttonProps:g,prefixCls:"".concat(S,"-btn")},h))))},h=n(50),g=n(52),C=n(38),y=function(e,t){var n=e.afterClose,a=e.config,r=c.useState(!0),i=Object(f.a)(r,2),l=i[0],s=i[1],u=c.useState(a),d=Object(f.a)(u,2),b=d[0],m=d[1],j=c.useContext(C.b),p=j.direction,O=j.getPrefixCls,y=O("modal"),x=O();function k(){s(!1);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t.some((function(e){return e&&e.triggerCancel}));b.onCancel&&a&&b.onCancel()}return c.useImperativeHandle(t,(function(){return{destroy:k,update:function(e){m((function(t){return Object(o.a)(Object(o.a)({},t),e)}))}}})),c.createElement(g.a,{componentName:"Modal",defaultLocale:h.a.Modal},(function(e){return c.createElement(v,Object(o.a)({prefixCls:y,rootPrefixCls:x},b,{close:k,visible:l,afterClose:n,okText:b.okText||(b.okCancel?e.okText:e.justOkText),direction:p,cancelText:b.cancelText||e.cancelText}))}))},x=c.forwardRef(y),k=n(30),S=n(155),E=n(154),T=n(156),N=n(157),w=n(91),F=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},P="";function I(e){var t=document.createElement("div");document.body.appendChild(t);var n=Object(o.a)(Object(o.a)({},e),{close:i,visible:!0});function a(){var n=k.unmountComponentAtNode(t);n&&t.parentNode&&t.parentNode.removeChild(t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];var r=o.some((function(e){return e&&e.triggerCancel}));e.onCancel&&r&&e.onCancel.apply(e,o);for(var l=0;l<J.length;l++){var s=J[l];if(s===i){J.splice(l,1);break}}}function r(e){var n=e.okText,a=e.cancelText,r=e.prefixCls,i=F(e,["okText","cancelText","prefixCls"]);setTimeout((function(){var e=Object(w.b)(),l=(0,Object(p.b)().getPrefixCls)(void 0,P),s=r||"".concat(l,"-modal");k.render(c.createElement(v,Object(o.a)({},i,{prefixCls:s,rootPrefixCls:l,okText:n||(i.okCancel?e.okText:e.justOkText),cancelText:a||e.cancelText})),t)}))}function i(){for(var t=this,c=arguments.length,i=new Array(c),l=0;l<c;l++)i[l]=arguments[l];r(n=Object(o.a)(Object(o.a)({},n),{visible:!1,afterClose:function(){"function"===typeof e.afterClose&&e.afterClose(),a.apply(t,i)}}))}return r(n),J.push(i),{destroy:i,update:function(e){r(n="function"===typeof e?e(n):Object(o.a)(Object(o.a)({},n),e))}}}function A(e){return Object(o.a)(Object(o.a)({icon:c.createElement(N.a,null),okCancel:!1},e),{type:"warning"})}function z(e){return Object(o.a)(Object(o.a)({icon:c.createElement(S.a,null),okCancel:!1},e),{type:"info"})}function M(e){return Object(o.a)(Object(o.a)({icon:c.createElement(E.a,null),okCancel:!1},e),{type:"success"})}function R(e){return Object(o.a)(Object(o.a)({icon:c.createElement(T.a,null),okCancel:!1},e),{type:"error"})}function V(e){return Object(o.a)(Object(o.a)({icon:c.createElement(N.a,null),okCancel:!0},e),{type:"confirm"})}var B=0,D=c.memo(c.forwardRef((function(e,t){var n=function(){var e=c.useState([]),t=Object(f.a)(e,2),n=t[0],a=t[1];return[n,c.useCallback((function(e){return a((function(t){return[].concat(Object(u.a)(t),[e])})),function(){a((function(t){return t.filter((function(t){return t!==e}))}))}}),[])]}(),a=Object(f.a)(n,2),o=a[0],r=a[1];return c.useImperativeHandle(t,(function(){return{patchElement:r}}),[]),c.createElement(c.Fragment,null,o)})));var L,H=n(152),_=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},J=[];Object(H.a)()&&document.documentElement.addEventListener("click",(function(e){L={x:e.pageX,y:e.pageY},setTimeout((function(){L=null}),100)}),!0);var G=function(e){var t,n=c.useContext(C.b),i=n.getPopupContainer,u=n.getPrefixCls,f=n.direction,m=function(t){var n=e.onCancel;null===n||void 0===n||n(t)},j=function(t){var n=e.onOk;null===n||void 0===n||n(t)},p=function(t){var n=e.okText,a=e.okType,r=e.cancelText,i=e.confirmLoading;return c.createElement(c.Fragment,null,c.createElement(d.a,Object(o.a)({onClick:m},e.cancelButtonProps),r||t.cancelText),c.createElement(d.a,Object(o.a)({},Object(b.a)(a),{loading:i,onClick:j},e.okButtonProps),n||t.okText))},v=e.prefixCls,h=e.footer,y=e.visible,x=e.wrapClassName,k=e.centered,S=e.getContainer,E=e.closeIcon,T=e.focusTriggerAfterClose,N=void 0===T||T,F=_(e,["prefixCls","footer","visible","wrapClassName","centered","getContainer","closeIcon","focusTriggerAfterClose"]),P=u("modal",v),I=u(),A=c.createElement(g.a,{componentName:"Modal",defaultLocale:Object(w.b)()},p),z=c.createElement("span",{className:"".concat(P,"-close-x")},E||c.createElement(s.a,{className:"".concat(P,"-close-icon")})),M=l()(x,(t={},Object(a.a)(t,"".concat(P,"-centered"),!!k),Object(a.a)(t,"".concat(P,"-wrap-rtl"),"rtl"===f),t));return c.createElement(r.a,Object(o.a)({},F,{getContainer:void 0===S?i:S,prefixCls:P,wrapClassName:M,footer:void 0===h?A:h,visible:y,mousePosition:L,onClose:m,closeIcon:z,focusTriggerAfterClose:N,transitionName:Object(O.b)(I,"zoom",e.transitionName),maskTransitionName:Object(O.b)(I,"fade",e.maskTransitionName)}))};G.useModal=function(){var e=c.useRef(null),t=c.useState([]),n=Object(f.a)(t,2),a=n[0],o=n[1];c.useEffect((function(){a.length&&(Object(u.a)(a).forEach((function(e){e()})),o([]))}),[a]);var r=c.useCallback((function(t){return function(n){var a;B+=1;var r,i=c.createRef(),l=c.createElement(x,{key:"modal-".concat(B),config:t(n),ref:i,afterClose:function(){r()}});return r=null===(a=e.current)||void 0===a?void 0:a.patchElement(l),{destroy:function(){function e(){var e;null===(e=i.current)||void 0===e||e.destroy()}i.current?e():o((function(t){return[].concat(Object(u.a)(t),[e])}))},update:function(e){function t(){var t;null===(t=i.current)||void 0===t||t.update(e)}i.current?t():o((function(e){return[].concat(Object(u.a)(e),[t])}))}}}}),[]);return[c.useMemo((function(){return{info:r(z),success:r(M),error:r(R),warning:r(A),confirm:r(V)}}),[]),c.createElement(D,{ref:e})]},G.defaultProps={width:520,confirmLoading:!1,visible:!1,okType:"primary"};var X=G;function Y(e){return I(A(e))}var q=X;q.info=function(e){return I(z(e))},q.success=function(e){return I(M(e))},q.error=function(e){return I(R(e))},q.warning=Y,q.warn=Y,q.confirm=function(e){return I(V(e))},q.destroyAll=function(){for(;J.length;){var e=J.pop();e&&e()}},q.config=function(e){var t=e.rootPrefixCls;Object(j.a)(!1,"Modal","Modal.config is deprecated. Please use ConfigProvider.config instead."),P=t};t.a=q},375:function(e,t,n){"use strict";n.r(t);var a=n(31),o=n(0),c=n(101),r=n(25),i=n(374),l=n(213),s=n(44),u=n(132),f=n(130),d=n(9);var b=function(e){var t=e.routerSearchObj;return Object(d.jsx)("div",{className:"m-content-tool",children:Object(d.jsx)("div",{className:"m-content-tool-row",children:Object(d.jsx)(f.b,{to:"/light/formview?id=".concat(t.id),target:"_blank",children:Object(d.jsxs)(s.a,{className:"m-space",type:"primary",children:[Object(d.jsx)(u.c,{name:"add",className:"m-tool-btn-icon"}),"\u6dfb\u52a0"]})})})})},m=n(330),j=(n(337),n(100),function(e){return[].concat(Object(m.a)(e.columns),[{title:"\u64cd\u4f5c",width:220,render:function(t){return Object(d.jsxs)("div",{className:"m-action",children:[Object(d.jsx)(s.a,{className:"m-action-btn",size:"small",danger:!0,onClick:function(){return e.onDelete(t)},children:"\u5220\u9664"}),Object(d.jsx)(s.a,{className:"m-action-btn",size:"small",onClick:function(){return e.onCheck(t)},children:"\u67e5\u770b"}),Object(d.jsx)(s.a,{className:"m-action-btn",size:"small",onClick:function(){return e.onEdit(t)},children:"\u7f16\u8f91"})]})}}])}),p=n(131),O=n(148),v=n(49),h=i.a.confirm;var g=n(209),C=i.a.confirm;t.default=Object(c.b)((function(e){return{}}),(function(e){return{onSetState:function(t,n){e({type:"SET_LIGHT_STATE",key:t,value:n})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=function(e){var t=Object(o.useState)(),n=Object(p.a)(t,2),c=n[0],r=n[1],i=Object(o.useState)(1),s=Object(p.a)(i,2),u=s[0],f=s[1],d=Object(o.useState)({columns:[],dataSource:[],pageSize:10}),b=Object(p.a)(d,2),m=b[0],j=b[1],g=l.a.useForm(),C=Object(p.a)(g,1)[0],y=Object(o.useState)(!1),x=Object(p.a)(y,2),k=x[0],S=x[1],E=Object(o.useState)({}),T=Object(p.a)(E,2),N=T[0],w=T[1],F=Object(o.useState)("add"),P=Object(p.a)(F,2),I=P[0],A=P[1],z=Object(o.useState)(),M=Object(p.a)(z,2),R=M[0],V=M[1],B=Object(o.useState)([]),D=Object(p.a)(B,2),L=D[0],H=D[1],_=Object(v.g)(e),J=_.id,G={},X=function(e){return e.filter((function(e){return e.isColumn})).map((function(e){return{title:e.title,dataIndex:e.dataIndex,render:function(t,n){var a=Object(v.f)().find((function(t){return t.renderFunName===e.renderFunName}));return a?a.render(t,n):t}}}))},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,n=void 0===t?1:t,a=e.pageSize,o=void 0===a?m.pageSize:a,c=e.searchParams,i=void 0===c?{}:c;O.a.light.tableSearch({tableId:J,page:n,pageSize:o,searchParams:i}).then((function(e){200===e.code&&(j({columns:X(e.data.fields),dataSource:e.data.list,pageSize:e.data.pageSize}),H(Object(v.c)(e.data.fields)),r(e.data.total),f(e.data.current))}))};return Object(o.useEffect)((function(){Y()}),[e.location.search]),Object(o.useEffect)((function(){C.resetFields()}),[k,C]),{dataSource:m.dataSource,total:c,current:u,pageSize:m.pageSize,columns:m.columns,isModalVisible:k,initValues:N,type:I,form:C,modalTitle:R,modalFields:L,routerSearchObj:_,handleSearch:Y,handleDelete:function(e){console.log("\u5220\u9664, id:",e.id),h({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){O.a.light.tableDelete({tableId:J,ids:[e.id]}).then((function(e){200===e.code&&Y()}))}})},handleAdd:function(){A("add"),w(G),V("\u6dfb\u52a0"),S(!0)},handleEdit:function(e){console.log("\u7f16\u8f91, id:",e),A("edit"),w(Object(a.a)(Object(a.a)({},N),e)),V("\u7f16\u8f91"),S(!0)},handleCheck:function(e){A("check"),w(Object(a.a)(Object(a.a)({},N),e)),V("\u67e5\u770b"),S(!0)},setIsModalVisible:S,handleFinish:function(e){console.log("Success:",e),"add"===I?O.a.light.tableAdd({tableId:J,dataItem:e}).then((function(e){200===e.code&&(S(!1),Y())})):"edit"===I&&O.a.light.tableEdit({tableId:J,id:N.id,dataItem:Object(a.a)(Object(a.a)({},N),e)}).then((function(e){200===e.code&&(S(!1),Y())}))},handleFinishFailed:function(e){console.log("Failed:",e)}}}(e),n=t.dataSource,c=t.total,r=t.current,f=t.pageSize,m=t.columns,y=t.isModalVisible,x=t.initValues,k=t.type,S=t.form,E=t.modalTitle,T=t.modalFields,N=t.routerSearchObj,w=t.handleSearch,F=t.handleDelete,P=t.handleAdd,I=t.handleEdit,A=t.handleCheck,z=t.setIsModalVisible,M=t.handleFinish,R=t.handleFinishFailed,V=function(){var e=Object(o.useState)([]),t=Object(p.a)(e,2),n=t[0],a=t[1];return{handleRowSelect:function(e,t){console.log(e,t),a(e)},handleOperate:function(e){var t=e.type;0===n.length?g.b.warning("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u9879"):0===t?C({title:"\u786e\u8ba4\u8981\u6279\u91cf\u63d0\u4ea4\u767e\u5ea6\u5ba1\u6838\u5417?",onOk:function(){console.log(n)}}):1===t?C({title:"\u786e\u8ba4\u6279\u91cf\u66f4\u65b0\u6570\u636e\u5230\u767e\u5ea6\u5417?",onOk:function(){console.log(n)}}):2===t?C({title:"\u786e\u8ba4\u8981\u6279\u91cf\u67e5\u770b\u5ba1\u6838\u5417?",onOk:function(){console.log(n)}}):3===t?C({title:"\u786e\u8ba4\u8981\u6279\u91cf\u63d0\u4ea4\u767e\u5ea6\u5ba1\u6838\u5417?",onOk:function(){console.log(n)}}):4===t?C({title:"\u786e\u8ba4\u66f4\u65b0\u6570\u636e\u5230\u767e\u5ea6\u5417?",onOk:function(){console.log(n)}}):5===t?C({title:"\u786e\u8ba4\u8981\u67e5\u770b\u767e\u5ea6\u5ba1\u6838\u5417?",onOk:function(){console.log(n)}}):6===t&&C({title:"\u786e\u8ba4\u8981\u6279\u91cf\u7ed1\u5b9a\u5230\u5e97\u94fa\u5417?",onOk:function(){console.log(n)}})}}}().handleRowSelect;return Object(d.jsxs)("div",{children:[Object(d.jsx)(b,{routerSearchObj:N,onAdd:P}),Object(d.jsx)(u.f,{dataSource:n,total:c,current:r,pageSize:f,columns:m,onSearch:w,onDelete:F,onEdit:I,onCheck:A,onRowSelect:V,getColumns:j}),Object(d.jsx)(i.a,{title:E,visible:y,onCancel:function(){return z(!1)},footer:null,className:"m-modal-full-screen",forceRender:!0,children:Object(d.jsxs)(l.a,{form:S,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(a.a)({},x),onFinish:M,onFinishFailed:R,children:[T,Object(d.jsxs)(l.a.Item,{wrapperCol:{offset:4,span:17},className:"m-modal-footer",children:[("add"===k||"edit"===k)&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(s.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(d.jsx)(u.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(d.jsxs)(s.a,{className:"m-space",onClick:function(){S.resetFields()},children:[Object(d.jsx)(u.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]}),Object(d.jsx)(s.a,{className:"m-space",onClick:function(){return z(!1)},children:"\u53d6\u6d88"})]})]})})]})})))}}]);