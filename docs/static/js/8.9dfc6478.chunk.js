(this.webpackJsonpair=this.webpackJsonpair||[]).push([[8,14],{334:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r}));var n=a(31),i=a(148),c=(a(50),function(e){return function(t){i.a.light.routerSearch().then((function(a){200===a.code&&(t({type:"SET_LIGHT_STATE",key:["routerForApp"],value:a.data}),e&&e())}))}}),r=function(){return function(e){var t=localStorage.getItem("userInfoAdmin")?JSON.parse(localStorage.getItem("userInfoAdmin")):{};e({type:"SET_LIGHT_STATE",key:["userInfo"],value:Object(n.a)({},t)})}}},348:function(e,t,a){"use strict";a.r(t);var n=a(31),i=a(0),c=a(101),r=a(25),o=a(391),s=a(386),l=a(213),d=a(44),u=a(389),m=a(131),j=a(132),b=a(148),f=a(50),p=a(343);var h=a(9);t.default=Object(c.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=function(e){var t=l.a.useForm(),a=Object(j.a)(t,1)[0],n=Object(i.useState)([]),c=Object(j.a)(n,2),r=c[0],o=c[1],s=Object(i.useState)({}),d=Object(j.a)(s,2),u=d[0],m=(d[1],Object(i.useState)(!1)),h=Object(j.a)(m,2),O=h[0],g=h[1],x=Object(i.useState)(""),A=Object(j.a)(x,2),v=A[0],y=A[1],I=Object(i.useState)(!1),S=Object(j.a)(I,2),F=S[0],N=S[1],C=Object(i.useState)(),H=Object(j.a)(C,2),w=H[0],T=H[1],D=Object(i.useState)({}),E=Object(j.a)(D,2),k=E[0],R=E[1],M=Object(f.g)(e).id,B=e.previewSkin,P=function(){b.a.light.fieldsSearch({tableId:M}).then((function(e){if(200===e.code){var t=e.data.fields;o(Object(f.c)(e.data.fields)),y(e.data.title),R(e.data.skin?e.data.skin:{});var a=t.filter((function(e){return e.isModalField}));Array.isArray(a)&&a.length>0&&"image"===a[0].type&&N(!0)}}))};return Object(i.useEffect)((function(){P()}),[e.location.search]),Object(i.useEffect)((function(){B&&B.headerImg&&R(B)}),[B]),Object(i.useEffect)((function(){var e=new Image;p.a.toImage({image:e,content:document.location.href,logo:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAiGSURBVHhe7Z39qxRVGMfv3xMYUYQRRRRRRBFE1C8RRRhRRBBFBFEEEUVQN82XTDPFDNNME01KM8U0y0zzJbOummWm7t633b1333fa77lnI2/P3HveZubMnucLX/zB3Wdm53zuzJznPOecgYgVtBiAwMUABC4GIHAxAIGLAQhcDEDgYgACV+4BqJ3cFpW+eCEqffmiubvfL+9+I4o6bRk1HOUagE6zGl166wonHvv0MRk1LOUagIlvF5ONaeJWcUhGDUu5BaBTHYsKC64mG1PXYxvmyajhKbcAlL9+jWxME9d/3yujhqdcAtAaP0c2pIlHPrxXRg1TuQRgfPNTZGOauH5ql4wapnIHQOOvQ2RDmnhk9T0yarjKHQBoNKoxTVw/vVtGDVe5AqB6dD3ZkCYe/fhBGTVs5QaATr0cFd65hmxMEzcvHJORw1ZuABj//DmyIU0s0r4soVwA0PhjP9mQpm6cPywjs/wHoNOOistuIRvS1MMr7hCPFFYOACh/9QrZiLYeXf+wPELY8hoAl31+yhgKDl3eAtBp1qLiuzeSDefSE/uXyCOGKW8BKG17nmywJFw9tkEeNTx5CQCqfKiGStL1oZ3y6GHJOwDa5YvOxvm1PDhHvHOEJu8AcJnr13Vh/lXBZQi9AqC881WyYdJ0YdHcqDX2pzyj/pc3AFSPbyIbJAuj9xEKBF4AgIJMqiGydHHpTaLyqN+VOQCdxoS42FQjZO0QIMgcAKRkqYvviwFB89IJebb9p0wBKG1/ibzoJq7+vDmq/bad/D9bow6hefG4POv+UmYATHy3lLzYJq7sWyijRlHtxBbyM7YGBP2YJ8gEAPy1UhfZxFRxByp9L719Jfl5W/dbFXHqANTP7iMvrIlLO16WUf8vFH0UFl9Hfs/W6LL2i1IFAM9RZNuoi6prvD/Mptbo2Wj4/dvI79t68uAqeZR8KzUAkFhx9Rc501/+dLUnR6KRNfeTcWxd2TtfHiW/SgUA9KVd9fUrexfIqBrqtKPxrc+Q8WyNtQXyrMQBwOieq8a3Ld6o7HmTjGvrsQ2PirUK8qhEAWhXCqIAk7poup48/JGMaqfqkXVkfFtjFLNdOi+Pkh8lBgAuxvDyW8mLpeXBOVFtaIeM6kaNcwcTST8jZt5KzhMBoN1t/OJ7N5MXSceI0fz7iIzqVu3yBTE9jDqurWu/bJVH8V/OAUDXy0Xjj6y5TzRS0kqq7DwvxaZOARD9/EVzyQuiY0wDi9otGTV5oSiUOg9bo7DVdzkDoH5mj5NavokDy2XEdAV4kyhHQw7C5yFlJwBUj20kf7yOi0tuyH6+fveug8ki1PnZuLj4ejG/0UdZA+BiVA81AW2PulAYrCosvJY8Vxv7mD62AgBZMOqH6hjJGVNh9hAGl/D4wUpfWj61SySp4tQaORONffIIec429i1zaAQA8uu2XSjM+EVD2AjjC1RsVU/+tFZGihfeSajv2li8FwyflkfIVtoAINFhO8KGVb4Aka3EcnGDc8hjqBhLzqgIuYjRtQ+QMUyNR4wPVUZaANiu0YMf7XIeHgCwWTZG91xcVjHBPrwTKANg+3Y8tvFx57X2aQMAoUAUgz9UPF2j95S1ZgWgWTgpsnLUD1AxEkOqt1pdZQFAT/hNttPXvQdAZMgsnrHjW55OtHuXJQBQe2LY6s7oLQD4YTbLsQ6vvCuV6dZZA9BT49yBaHTdQ+QxZrKXAKDhbAZzRJlUqyGjJStfAOgJCaThFbeTx6I8KwAqO5hY7nLyLwBIiuCWTZ2oinHHwPtCmvINAAjJKfQWVDKJcQD06hgBE+6msf7gTvEZJMNMJQDAC41pwSZONKscvo8A9ISh7PKu12ecnxALQPePkfp8nDEZxlQDJs8uGMmgrJ9hPgPQE1LKcSnzWAAqBa1hdUyJM9UAFXAmY2Rr4vtlXhRB5gGAnprFX0XxyX/nRcQdP1UAVEe9MNaPaVg4OV+UJwB6wjnjOuLREJcJ9AoA0fDdZ1ka5Vm6yiMAPbVL58X5U/ICABRoVL4Z9GqcfrryDMBMyhQA1PFP/rAy6tRK8iOaMumXGvZlGYApO3kJxPg+Ehk2QmGG6Luif0r1W+Pc/Q6GW3VX8GYApmwFACZauqpXs13pS7dGgAGYshUA8l8nslniFe8c2A1URwzAlBkAIp6KGQAGQEbySwyAomwB8HkOn87YjM2E1KABwJRzLFSpa9XhboyOTv64Wtxp1L1RdMN1ZlkhxYzv0fFoIwuJWdJBA4CLjDyIricPrZFnMLOQSKOO64sxhB80AKbGeL+KXFcRuzZGKRkAA+MWrSKMmlLf98WoZ2QADMwAxIgBuFwMgIYZgPTNABiaAYgRA3C5GAANMwDpmwEwNBpWRdjHgPq+Lx7f+iwDYLKvgOodAJ+jMokqpo4bZ9OMJlLIQQOATB1iYNcyVaO8W/k8Ww1yLGE2Y61FNBB1zpQxMYSKM6ubtbABsBlGTVJoGJ3hYJuldoIGAKNiPorrARTFAEyZASDiqZgBYABkJL/EACiKAZgyA0DEUzEDwADISH6JAVAUAzBlBoCIp2IGgAGQkfwSA6CovgZA43cxAEQ8FXsLQJqrhMl/nYgBcCMMBmGqPfYzwDnG+uh6MbsJ18FUDEDgYgACFwMQuBiAwMUABC63AAztIC+0irH7hu7ys7r95em2XRWtH+QUAOzFR11oFQMA3f2CccewASBPu3wnpYHxz54UGyRiIyQrb3rCau9dLKKMHUSxuRQZf7q7nxN7F1psaTOy6m5x3mT8zDxPtAeqj9OQ9mrh7HRsswmEjpRXC2ena6zfk4YYAE/NAARuBiBwMwCBmwEI3KkBQB2cnb1T6wY6SwSxHTnlRJD8lxWoGIDAxQAELgYgcDEAgYsBCFwMQOBiAAIXAxC4GIDAxQAErSj6Bwim9ux3XKqJAAAAAElFTkSuQmCC"}}),e.id="m-img",e.style="display:none;",document.body.appendChild(e);var t=document.getElementById("m-img");setTimeout((function(){T(t.src)}),500)}),[]),{form:a,initValues:u,fieldsDom:r,isShowResult:O,title:v,isImageFirst:F,qrCodeImageUrl:w,skin:k,handleSearch:P,handleFinish:function(e){console.log("Success:",e),b.a.light.tableAdd({tableId:M,dataItem:e}).then((function(e){200===e.code&&g(!0)}))},handleFinishFailed:function(e){console.log("Failed:",e)}}}(e),a=t.initValues,c=t.form,r=t.fieldsDom,O=t.isShowResult,g=t.title,x=t.isImageFirst,A=t.qrCodeImageUrl,v=t.skin,y=t.handleFinish,I=t.handleFinishFailed;return Object(h.jsx)("div",{className:"m-formview-wrap",style:{backgroundImage:"url(".concat(v.backgroundImg,")")},children:Object(h.jsx)("div",{className:"m-formview-inner",children:O?Object(h.jsx)(u.a,{status:"success",title:"\u63d0\u4ea4\u6210\u529f",subTitle:"\u611f\u8c22\u60a8\u7684\u53c2\u4e0e",extra:Object(h.jsx)(d.a,{type:"primary",onClick:function(){document.location.reload()},children:"\u8fd4\u56de"})}):Object(h.jsxs)(h.Fragment,{children:[v.headerImg&&Object(h.jsx)("div",{className:"m-formview-header-img-wrap",children:Object(h.jsx)("img",{className:"m-formview-header-img",alt:"\u8868\u5934",src:v.headerImg})}),Object(h.jsx)("div",{className:"m-formview-header-text ".concat(x?"image-first":""),children:Object(h.jsxs)(o.b,{children:[Object(h.jsx)("span",{children:g}),A&&Object(h.jsx)(s.a,{className:"m-qrcode-img",src:A,alt:"\u4e8c\u7ef4\u7801",preview:{mask:""}})]})}),Object(h.jsxs)(l.a,{form:c,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(n.a)({},a),onFinish:y,onFinishFailed:I,children:[r,Object(h.jsxs)(l.a.Item,{wrapperCol:{offset:4,span:17},className:"m-formview-formitem m-formview-formitem-footer-mobile",children:[Object(h.jsxs)(d.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(h.jsx)(m.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(h.jsxs)(d.a,{className:"m-space",onClick:function(){c.resetFields()},children:[Object(h.jsx)(m.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]})]})]})})})})))},385:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(101),c=a(31),r=a(25),o=a(121),s=a(73),l=a(375),d=a(213),u=a(44),m=a(100),j=a(9),b=a(131),f=a(132),p=a(148),h=a(334),O=l.a.confirm;var g=Object(i.b)((function(e){return{routerForApp:e.getIn(["light","routerForApp"]).toJS()}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=function(e){var t=d.a.useForm(),a=Object(f.a)(t,1)[0],i=Object(n.useState)(!1),r=Object(f.a)(i,2),o=r[0],s=r[1],l=Object(n.useState)({}),u=Object(f.a)(l,2),m=u[0],j=u[1],b=Object(n.useState)("add"),g=Object(f.a)(b,2),x=g[0],A=g[1],v=Object(n.useState)(),y=Object(f.a)(v,2),I=y[0],S=y[1],F=e.routerForApp,N={},C=function(){e.onDispatch(Object(h.a)())};return Object(n.useEffect)((function(){C()}),[]),Object(n.useEffect)((function(){a.resetFields()}),[o,a]),{isModalVisible:o,initValues:m,type:x,form:a,modalTitle:I,handleDelete:function(t){console.log("\u5220\u9664, id:",t),O({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){p.a.light.routerDelete({ids:[t]}).then((function(t){200===t.code&&e.onDispatch(Object(h.a)())}))}})},handleAdd:function(){A("add"),S("\u6dfb\u52a0\u5e94\u7528"),j(N),console.log(N),s(!0)},handleEdit:function(e){var t=F.find((function(t){return t.id===e}));console.log("\u7f16\u8f91, id:",t),A("edit"),S("\u4fee\u6539\u540d\u79f0"),j(Object(c.a)(Object(c.a)({},m),t)),s(!0)},setIsModalVisible:s,handleFinish:function(e){console.log("Success:",e),"add"===x?(e.path="/light/index/content",p.a.light.routerAdd({dataItem:e}).then((function(e){200===e.code&&(s(!1),C())}))):"edit"===x&&p.a.light.routerEdit({id:m.id,dataItem:Object(c.a)(Object(c.a)({},m),e)}).then((function(e){200===e.code&&(s(!1),C())}))},handleFinishFailed:function(e){console.log("Failed:",e)},handleJumpToSet:function(t){e.history.push("/light/admin/app?type=detail&id=".concat(t,"&progress=edit"))}}}(e),a=t.isModalVisible,i=t.initValues,r=t.type,g=t.form,x=t.modalTitle,A=t.handleDelete,v=t.handleAdd,y=t.handleEdit,I=t.setIsModalVisible,S=t.handleFinish,F=t.handleFinishFailed,N=t.handleJumpToSet,C=e.routerForApp;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"m-admin-content home",children:[Object(j.jsxs)("div",{className:"m-admin-row",children:[Object(j.jsx)("div",{className:"m-adimn-row-title",children:"\u81ea\u5b9a\u4e49\u5e94\u7528"}),Object(j.jsxs)("div",{className:"m-app-wrap",children:[C.map((function(e){return Object(j.jsxs)("div",{className:"m-app-item",title:e.title,onClick:function(){return N(e.id)},children:[Object(j.jsx)(o.a,{overlay:Object(j.jsxs)(s.a,{onClick:function(e){return e.domEvent.stopPropagation()},children:[Object(j.jsx)(s.a.Item,{onClick:function(){return y(e.id)},children:"\u4fee\u6539\u540d\u79f0"},"0"),Object(j.jsx)(s.a.Item,{onClick:function(){return A(e.id)},children:"\u5220\u9664\u5e94\u7528"},"1")]}),children:Object(j.jsx)("span",{className:"m-app-item-icon",children:Object(j.jsx)(b.c,{name:"more"})})}),e.title]},e.id)})),Object(j.jsxs)("div",{className:"m-app-item",onClick:v,children:[Object(j.jsx)(b.c,{name:"add",className:"m-application-icon"}),"\u521b\u5efa\u65b0\u5e94\u7528"]})]})]}),Object(j.jsx)(l.a,{title:x,visible:a,onCancel:function(){return I(!1)},footer:null,forceRender:!0,children:Object(j.jsxs)(d.a,{form:g,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(c.a)({},i),onFinish:S,onFinishFailed:F,children:[Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(d.a.Item,{label:"\u5e94\u7528\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})})}),Object(j.jsxs)(d.a.Item,{wrapperCol:{offset:4,span:17},className:"m-modal-footer",children:[("add"===r||"edit"===r)&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(u.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(j.jsx)(b.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(j.jsxs)(u.a,{className:"m-space",onClick:function(){g.resetFields()},children:[Object(j.jsx)(b.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]}),Object(j.jsx)(u.a,{className:"m-space",onClick:function(){return I(!1)},children:"\u53d6\u6d88"})]})]})})]})})}))),x=a(388),A=a(342),v=a(337),y=a(390),I=a(130),S=y.a.Step;var F=Object(r.g)((function(e){var t=e.applicationTitle,a=e.routerSearchObj,i=e.onSave,c=Object(n.useState)(0),r=Object(f.a)(c,2),o=r[0],s=r[1],l=[{id:0,title:"\u7f16\u8f91",type:"edit",path:"/light/admin/app?type=detail&id=".concat(a.id,"&progress=edit")},{id:1,title:"\u76ae\u80a4",type:"skin",path:"/light/admin/app?type=detail&id=".concat(a.id,"&progress=skin")},{id:2,title:"\u8bbe\u7f6e",type:"set",path:"/light/admin/app?type=detail&id=".concat(a.id,"&progress=set")},{id:3,title:"\u53d1\u5e03",type:"publish",path:"/light/admin/app?type=detail&id=".concat(a.id,"&progress=publish")}];return Object(n.useEffect)((function(){var e=l.find((function(e){return e.type===a.progress}));s(e.id)}),[]),Object(j.jsxs)("div",{className:"m-design-header",children:[Object(j.jsxs)("div",{className:"m-design-header-title",children:[Object(j.jsx)(b.c,{name:"goback",title:"\u8fd4\u56de",className:"m-set-application-header-icon",onClick:function(){return e.history.go(-1)}}),Object(j.jsx)("span",{title:t,children:t})]}),Object(j.jsx)("div",{className:"m-design-header-middle",children:Object(j.jsx)("div",{className:"m-design-header-middle-inner",children:Object(j.jsx)(y.a,{current:o,onChange:function(t){var a=l.find((function(e){return e.id===t}));e.history.replace(a.path)},children:l.map((function(e){return Object(j.jsx)(S,{title:e.title},e.id)}))})})}),Object(j.jsxs)("div",{className:"m-design-header-action",children:[Object(j.jsx)(u.a,{type:"primary",onClick:i,children:"\u4fdd\u5b58"}),Object(j.jsx)(I.b,{to:"/light/formview?id=".concat(a.id),target:"_blank",style:{display:"inherit"},children:Object(j.jsx)(u.a,{children:"\u9884\u89c8"})})]})]})})),N=a(332),C=a(209),H=a(50),w=a(377),T=function(e){var t=e.initValuesForAttr;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.a.Item,{label:"\u5b57\u6bb5\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})}),t.isHasPlaceHolder&&Object(j.jsx)(d.a.Item,{label:"placeholder",name:"placeholder",children:Object(j.jsx)(m.a,{})}),Object(j.jsx)(d.a.Item,{label:"\u82f1\u6587\u540d\u79f0",name:"dataIndex",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0\uff01"}],children:Object(j.jsx)(m.a,{})}),t.isHasRules&&Object(j.jsx)(d.a.Item,{label:"\u5b57\u6bb5\u5fc5\u586b",name:"rules",children:Object(j.jsx)(b.b,{})}),"image"===t.type&&Object(j.jsx)(d.a.Item,{label:"\u4e0a\u4f20\u56fe\u7247",name:"src",children:Object(j.jsx)(b.g,{})})]})},D=l.a.confirm,E=[];function k(e){var t=d.a.useForm(),a=Object(f.a)(t,1)[0],i=d.a.useForm(),r=Object(f.a)(i,1)[0],o=Object(n.useState)([]),s=Object(f.a)(o,2),l=s[0],u=s[1],m=Object(n.useState)(),j=Object(f.a)(m,2),b=j[0],h=j[1],O=Object(n.useState)(),g=Object(f.a)(O,2),x=g[0],A=g[1],v=Object(n.useState)({}),y=Object(f.a)(v,2),I=y[0],S=y[1],F=Object(H.g)(e),T=F.id,k=function(){p.a.light.fieldsSearch({tableId:T}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));u(t),h(e.data.title),Array.isArray(t)&&t.length>0&&R({id:t[0].id,myDataSource:t})}}))},R=function(e){var t=e.id,a=e.myDataSource,n=void 0===a?l:a;A(t);var i=n.find((function(e){return e.id===t})),r=Array.isArray(i.rules)&&i.rules.length>0?i.rules[0]:{message:"".concat(i.title,"\u4e0d\u80fd\u4e3a\u7a7a")};S(Object(c.a)(Object(c.a)({},i),{},{rules:r}))};return Object(n.useEffect)((function(){r.resetFields()}),[I]),Object(n.useEffect)((function(){k()}),[]),Object(n.useEffect)((function(){E=l}),[l]),{form:a,formForAttr:r,initValuesForAttr:I,dataSource:l,applicationTitle:b,addInitValues:{},routerSearchObj:F,cardActiveId:x,handleSearch:k,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),D({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=l.filter((function(e){return e.id!==t.id}));u(e),Array.isArray(e)&&e.length>0?t.id===x&&R({id:e[0].id,myDataSource:e}):A(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,a=E.map((function(e){return e.orderIndex})),n=Math.max.apply(Math,a)+1,i=Object(w.a)(),r={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:n};console.log(Object(c.a)(Object(c.a)({},t),r)),console.log(E);var o=[].concat(Object(N.a)(E),[Object(c.a)(Object(c.a)({},t),r)]);u(o),Array.isArray(o)&&o.length>0&&R({id:i,myDataSource:o})},handleSave:function(){console.log(l);var e=l.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{orderIndex:t+1})}));console.log(e),p.a.light.fieldsEditAll({tableId:T,dataItem:e}).then((function(e){200===e.code&&C.b.success(e.message)}))},handleCardActiveId:R,handleValuesChange:function(e,t){var a=r.getFieldsValue();console.log(a);var n=l.findIndex((function(e){return e.id===x})),i={rules:[t.rules],props:{placeholder:t.placeholder}};l[n]=Object(c.a)(Object(c.a)(Object(c.a)({},l[n]),t),i),u(Object(N.a)(l))},handleGetChildPayload:function(e){var t=e.type,a=e.index;if("tool"===t){var n=Object(w.a)(),i=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],r=E.map((function(e){return e.orderIndex})),o=Math.max.apply(Math,r)+1,s=i[a],d={id:n,dataIndex:"".concat(s.dataIndex,"-").concat(n),isModalField:!0,orderIndex:o};return Object(c.a)(Object(c.a)({},s),d)}if("content"===t)return l[a]},handleCardDrop:function(e){var t=e.type,a=e.dragResult;if("tool"===t);else if("content"===t){var n=function(e,t){var a=t.removedIndex,n=t.addedIndex,i=t.payload;if(null===a&&null===n)return e;var c=Object(N.a)(e),r=i;return null!==a&&(r=c.splice(a,1)[0]),null!==n&&c.splice(n,0,r),c}(l,a);u(n),Array.isArray(n)&&n.length>0&&R({id:a.payload.id,myDataSource:n})}}}}var R=a(338),M=x.a.Panel;var B=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=k(e),a=t.applicationTitle,n=t.dataSource,i=t.form,r=t.formForAttr,o=t.initValues,s=t.initValuesForAttr,l=t.routerSearchObj,f=t.cardActiveId,p=t.handleFinish,h=t.handleFinishFailed,O=t.handleAdd,g=t.handleSave,y=t.handleCardActiveId,I=t.handleValuesChange,S=t.handleDelete,N=t.handleGetChildPayload,C=t.handleCardDrop;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(F,{applicationTitle:a,routerSearchObj:l,onSave:g}),Object(j.jsxs)("div",{className:"m-design-wrap",children:[Object(j.jsx)("div",{className:"m-design-sidebar",children:Object(j.jsxs)(x.a,{defaultActiveKey:["1","2","3"],children:[Object(j.jsx)(M,{header:"\u901a\u7528\u5b57\u6bb5",children:Object(j.jsx)("div",{className:"m-design-sidebar-container",children:Object(j.jsx)(R.Container,{orientation:"horizontal",onDrop:function(e){return C({type:"tool",dragResult:e})},getChildPayload:function(e){return N({type:"tool",index:e})},behaviour:"copy",groupName:"col",children:[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}].map((function(e){return Object(j.jsx)(R.Draggable,{children:Object(j.jsxs)("div",{className:"m-component-item",onClick:function(){return O({fieldInfo:e})},children:[Object(j.jsx)("div",{children:Object(j.jsx)(b.c,{name:e.icon})}),Object(j.jsx)("div",{children:e.title})]})},e.id)}))})})},"1"),Object(j.jsx)(M,{header:"\u8054\u7cfb\u4fe1\u606f\u5b57\u6bb5",children:Object(j.jsx)(A.a,{gutter:[2,2],children:Object(j.jsx)(v.a,{span:8,children:Object(j.jsxs)("div",{className:"m-component-item",children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{children:"\u656c\u8bf7\u671f\u5f85"})]})})})},"2"),Object(j.jsx)(M,{header:"\u5546\u54c1\u5b57\u6bb5",children:Object(j.jsx)(A.a,{gutter:[2,2],children:Object(j.jsx)(v.a,{span:8,children:Object(j.jsxs)("div",{className:"m-component-item",children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{children:"\u656c\u8bf7\u671f\u5f85"})]})})})},"3")]})}),Object(j.jsx)("div",{className:"m-design-content",children:Object(j.jsxs)(d.a,{form:i,labelCol:{span:4},wrapperCol:{span:17},initialValues:Object(c.a)({},o),onFinish:p,onFinishFailed:h,children:[Object(j.jsx)("div",{className:"m-design-card-wrap",children:Object(j.jsx)(R.Container,{orientation:"vertical",onDrop:function(e){return C({type:"content",dragResult:e})},getChildPayload:function(e){return N({type:"content",index:e})},groupName:"col",children:n.map((function(e){var t=Object(H.d)().find((function(t){return t.formComponentName===e.formComponentName}));return Object(j.jsx)(R.Draggable,{children:Object(j.jsxs)("div",{className:"m-design-card ".concat(f===e.id?"active":""),onClick:function(){return y({id:e.id})},children:[Object(j.jsxs)("div",{className:"m-design-card-info",children:["formItem"===e.type&&Object(j.jsx)(d.a.Item,{label:e.title,name:e.dataIndex,rules:e.rules,children:t?t.getComponent({props:e.props}):Object(j.jsx)(m.a,{})},e.id),"image"===e.type&&Object(j.jsx)(d.a.Item,{name:e.dataIndex,wrapperCol:24,children:t?t.getComponent({props:{src:e.src}}):Object(j.jsx)(m.a,{})},e.id)]}),Object(j.jsx)("div",{className:"m-design-card-action ".concat(f===e.id?"active":""),children:Object(j.jsx)(b.c,{name:"delete",className:"m-design-card-delete",onClick:function(t){return S(t,e)}})})]})},e.id)}))})}),Object(j.jsxs)(d.a.Item,{wrapperCol:{offset:4,span:17},className:"m-design-footer",children:[Object(j.jsxs)(u.a,{type:"primary",htmlType:"submit",className:"m-space",children:[Object(j.jsx)(b.c,{name:"submit",className:"m-tool-btn-icon"}),"\u63d0\u4ea4"]}),Object(j.jsxs)(u.a,{className:"m-space",onClick:function(){i.resetFields()},children:[Object(j.jsx)(b.c,{name:"reset",className:"m-tool-btn-icon"}),"\u91cd\u7f6e"]})]})]})}),Object(j.jsx)("div",{className:"m-design-attr",children:Object(j.jsx)(d.a,{form:r,labelCol:{span:8},wrapperCol:{span:15},initialValues:Object(c.a)({},s),scrollToFirstError:!0,onValuesChange:I,onFinish:p,id:"m-set-application-modal-form",className:"m-set-application-modal-form",children:f?T({initValuesForAttr:s}):Object(j.jsx)("div",{className:"m-empty-text",children:"\u8bf7\u9009\u62e9\u5b57\u6bb5"})})})]})]})})));function P(e){var t=d.a.useForm(),a=Object(f.a)(t,1)[0],i=Object(n.useState)([]),r=Object(f.a)(i,2),o=r[0],s=r[1],l=Object(n.useState)(),u=Object(f.a)(l,2),m=u[0],j=u[1],b=Object(n.useState)({}),h=Object(f.a)(b,2),O=h[0],g=h[1],x=Object(H.g)(e),A=x.id;return Object(n.useEffect)((function(){p.a.light.fieldsSearch({tableId:A}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));s(t),j(e.data.title),g(e.data.skin?e.data.skin:{}),a.resetFields()}}))}),[]),{applicationTitle:m,routerSearchObj:x,skin:O,form:a,handleSave:function(){var e=o.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{orderIndex:t+1})}));p.a.light.fieldsEditAll({tableId:A,dataItem:e,skin:O}).then((function(e){200===e.code&&C.b.success(e.message)}))},handleValuesChange:function(e,t){g(t)}}}var V=a(348);var G=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=P(e),a=t.applicationTitle,n=t.routerSearchObj,i=t.skin,r=t.form,o=t.handleSave,s=t.handleValuesChange;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(F,{applicationTitle:a,routerSearchObj:n,onSave:o}),Object(j.jsxs)("div",{className:"m-design-wrap",children:[Object(j.jsx)("div",{className:"m-design-sidebar skin",children:Object(j.jsxs)(d.a,{form:r,labelCol:{span:8},wrapperCol:{span:15},initialValues:Object(c.a)({},i),onValuesChange:s,children:[Object(j.jsx)(d.a.Item,{label:"\u8868\u5934\u56fe\u7247",name:"headerImg",children:Object(j.jsx)(b.g,{})}),Object(j.jsx)(d.a.Item,{label:"\u80cc\u666f\u56fe\u7247",name:"backgroundImg",children:Object(j.jsx)(b.g,{})})]})}),Object(j.jsx)("div",{className:"m-design-content",children:Object(j.jsx)(V.default,{previewSkin:i})})]})]})}))),Q=l.a.confirm,J=[];function L(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),i=a[0],r=a[1],o=Object(n.useState)(),s=Object(f.a)(o,2),l=s[0],d=s[1],u=Object(n.useState)(),m=Object(f.a)(u,2),j=m[0],b=m[1],h=Object(n.useState)({}),O=Object(f.a)(h,2),g=O[0],x=O[1],A=Object(H.g)(e),v=A.id,y=function(){p.a.light.fieldsSearch({tableId:v}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));r(t),d(e.data.title),Array.isArray(t)&&t.length>0&&I({id:t[0].id,myDataSource:t})}}))},I=function(e){var t=e.id,a=e.myDataSource,n=void 0===a?i:a;b(t);var r=n.find((function(e){return e.id===t})),o=Array.isArray(r.rules)&&r.rules.length>0?r.rules[0]:{message:"".concat(r.title,"\u4e0d\u80fd\u4e3a\u7a7a")};x(Object(c.a)(Object(c.a)({},r),{},{rules:o}))};return Object(n.useEffect)((function(){y()}),[]),Object(n.useEffect)((function(){J=i}),[i]),{initValuesForAttr:g,dataSource:i,applicationTitle:l,addInitValues:{},routerSearchObj:A,cardActiveId:j,handleSearch:y,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),Q({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=i.filter((function(e){return e.id!==t.id}));r(e),Array.isArray(e)&&e.length>0?t.id===j&&I({id:e[0].id,myDataSource:e}):b(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,a=J.map((function(e){return e.orderIndex})),n=Math.max.apply(Math,a)+1,i=Object(w.a)(),o={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:n};console.log(Object(c.a)(Object(c.a)({},t),o)),console.log(J);var s=[].concat(Object(N.a)(J),[Object(c.a)(Object(c.a)({},t),o)]);r(s),Array.isArray(s)&&s.length>0&&I({id:i,myDataSource:s})},handleSave:function(){console.log(i);var e=i.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{orderIndex:t+1})}));console.log(e),p.a.light.fieldsEditAll({tableId:v,dataItem:e}).then((function(e){200===e.code&&C.b.success(e.message)}))},handleCardActiveId:I,handleValuesChange:function(e,t){},handleGetChildPayload:function(e){var t=e.type,a=e.index;if("tool"===t){var n=Object(w.a)(),r=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],o=J.map((function(e){return e.orderIndex})),s=Math.max.apply(Math,o)+1,l=r[a],d={id:n,dataIndex:"".concat(l.dataIndex,"-").concat(n),isModalField:!0,orderIndex:s};return Object(c.a)(Object(c.a)({},l),d)}if("content"===t)return i[a]},handleCardDrop:function(e){var t=e.type,a=e.dragResult;if("tool"===t);else if("content"===t){var n=function(e,t){var a=t.removedIndex,n=t.addedIndex,i=t.payload;if(null===a&&null===n)return e;var c=Object(N.a)(e),r=i;return null!==a&&(r=c.splice(a,1)[0]),null!==n&&c.splice(n,0,r),c}(i,a);r(n),Array.isArray(n)&&n.length>0&&I({id:a.payload.id,myDataSource:n})}}}}var q=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=L(e),a=t.applicationTitle,n=t.routerSearchObj,i=t.handleSave;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(F,{applicationTitle:a,routerSearchObj:n,onSave:i}),Object(j.jsx)("div",{className:"m-empty-page",children:"\u5360\u4f4d\u7a7a\u9875\u9762"})]})}))),U=l.a.confirm,Y=[];function Z(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),i=a[0],r=a[1],o=Object(n.useState)(),s=Object(f.a)(o,2),l=s[0],d=s[1],u=Object(n.useState)(),m=Object(f.a)(u,2),j=m[0],b=m[1],h=Object(n.useState)({}),O=Object(f.a)(h,2),g=O[0],x=O[1],A=Object(H.g)(e),v=A.id,y=function(){p.a.light.fieldsSearch({tableId:v}).then((function(e){if(200===e.code){var t=e.data.fields.filter((function(e){return!e.isSystem}));r(t),d(e.data.title),Array.isArray(t)&&t.length>0&&I({id:t[0].id,myDataSource:t})}}))},I=function(e){var t=e.id,a=e.myDataSource,n=void 0===a?i:a;b(t);var r=n.find((function(e){return e.id===t})),o=Array.isArray(r.rules)&&r.rules.length>0?r.rules[0]:{message:"".concat(r.title,"\u4e0d\u80fd\u4e3a\u7a7a")};x(Object(c.a)(Object(c.a)({},r),{},{rules:o}))};return Object(n.useEffect)((function(){y()}),[]),Object(n.useEffect)((function(){Y=i}),[i]),{initValuesForAttr:g,dataSource:i,applicationTitle:l,addInitValues:{},routerSearchObj:A,cardActiveId:j,handleSearch:y,handleDelete:function(e,t){e.stopPropagation(),console.log("\u5220\u9664, id:",t.id),U({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onOk:function(){var e=i.filter((function(e){return e.id!==t.id}));r(e),Array.isArray(e)&&e.length>0?t.id===j&&I({id:e[0].id,myDataSource:e}):b(!1)}})},handleFinish:function(e){console.log("Success:",e)},handleFinishFailed:function(e){console.log("Failed:",e)},handleAdd:function(e){var t=e.fieldInfo,a=Y.map((function(e){return e.orderIndex})),n=Math.max.apply(Math,a)+1,i=Object(w.a)(),o={id:i,dataIndex:"".concat(t.dataIndex,"-").concat(i),isModalField:!0,orderIndex:n};console.log(Object(c.a)(Object(c.a)({},t),o)),console.log(Y);var s=[].concat(Object(N.a)(Y),[Object(c.a)(Object(c.a)({},t),o)]);r(s),Array.isArray(s)&&s.length>0&&I({id:i,myDataSource:s})},handleSave:function(){console.log(i);var e=i.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{orderIndex:t+1})}));console.log(e),p.a.light.fieldsEditAll({tableId:v,dataItem:e}).then((function(e){200===e.code&&C.b.success(e.message)}))},handleCardActiveId:I,handleValuesChange:function(e,t){},handleGetChildPayload:function(e){var t=e.type,a=e.index;if("tool"===t){var n=Object(w.a)(),r=[{id:1,icon:"input",title:"\u5355\u884c\u6587\u672c",formComponentName:"Input",dataIndex:"input",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:2,icon:"textarea",title:"\u591a\u884c\u6587\u672c",formComponentName:"TextArea",dataIndex:"textArea",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:3,icon:"number-input",title:"\u6570\u5b57",formComponentName:"InputNumber",dataIndex:"inputNumber",renderFunName:"renderSpan",type:"formItem",isHasRules:!0,isHasPlaceHolder:!0,isColumn:!0},{id:4,icon:"image",title:"\u56fe\u7247",formComponentName:"Image",dataIndex:"image",renderFunName:"renderImage",type:"image",isHasRules:!1,isHasPlaceHolder:!1,src:"https://www.jsform.com/rs/images/defaultimg.png",isColumn:!1}],o=Y.map((function(e){return e.orderIndex})),s=Math.max.apply(Math,o)+1,l=r[a],d={id:n,dataIndex:"".concat(l.dataIndex,"-").concat(n),isModalField:!0,orderIndex:s};return Object(c.a)(Object(c.a)({},l),d)}if("content"===t)return i[a]},handleCardDrop:function(e){var t=e.type,a=e.dragResult;if("tool"===t);else if("content"===t){var n=function(e,t){var a=t.removedIndex,n=t.addedIndex,i=t.payload;if(null===a&&null===n)return e;var c=Object(N.a)(e),r=i;return null!==a&&(r=c.splice(a,1)[0]),null!==n&&c.splice(n,0,r),c}(i,a);r(n),Array.isArray(n)&&n.length>0&&I({id:a.payload.id,myDataSource:n})}}}}var K=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=Z(e),a=t.applicationTitle,n=t.routerSearchObj,i=t.handleSave;return Object(j.jsxs)("div",{className:"m-admin-content",children:[Object(j.jsx)(F,{applicationTitle:a,routerSearchObj:n,onSave:i}),Object(j.jsx)("div",{className:"m-empty-page",children:"\u5360\u4f4d\u7a7a\u9875\u9762"})]})})));var X=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))(Object(r.g)((function(e){var t=Object(H.g)(e),a=function(){var e={edit:{component:Object(j.jsx)(B,{})},skin:{component:Object(j.jsx)(G,{})},set:{component:Object(j.jsx)(q,{})},publish:{component:Object(j.jsx)(K,{})}};return t.progress?e[t.progress]?e[t.progress].component:null:Object(j.jsx)(B,{})};return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(j.Fragment,{children:a()})})})));t.default=Object(i.b)((function(e){return{}}),(function(e){return{onSetState:function(t,a){e({type:"SET_LIGHT_STATE",key:t,value:a})},onDispatch:function(t){e(t)}}}))((function(e){var t=Object(H.g)(e),a=function(){var e={list:{component:Object(j.jsx)(g,{})}};return t.type?e[t.type]?e[t.type].component:null:Object(j.jsx)(g,{})};return Object(j.jsx)(j.Fragment,{children:"detail"===t.type?Object(j.jsx)(X,{}):Object(j.jsx)(j.Fragment,{children:a()})})}))}}]);